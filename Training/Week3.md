### Question 1

**Scenario:** You have a table of customers with their names and email addresses. Retrieve the names and email addresses of all customers whose first name is 'John'.

**Table Structure:**

```sql
CREATE TABLE customers (
  customer_id SERIAL PRIMARY KEY,
  first_name VARCHAR(50),
  last_name VARCHAR(50),
  email VARCHAR(100)
);
```

**Sample Data:**

| customer_id | first_name | last_name | email                     |
|-------------|------------|-----------|--------------------------|
| 1           | John       | Doe       | john.doe@example.com     |
| 2           | Jane       | Doe       | jane.doe@example.com     |
| 3           | John       | Smith     | john.smith@example.com   |
| 4           | Alice      | Jones     | alice.jones@example.com   |

**Desired Output:**

| first_name | email                |
|------------|----------------------|
| John       | john.doe@example.com  |
| John       | john.smith@example.com |


### Question 2

**Scenario:** You have two tables: `orders` and `order_items`. Each order can have multiple order items.  Calculate the total revenue generated by each product category.

**Table Structures:**

```sql
CREATE TABLE orders (
  order_id SERIAL PRIMARY KEY,
  customer_id INT,
  order_date DATE
);

CREATE TABLE order_items (
  order_item_id SERIAL PRIMARY KEY,
  order_id INT REFERENCES orders(order_id),
  product_id INT,
  quantity INT,
  unit_price DECIMAL(10,2)
);

CREATE TABLE products (
  product_id SERIAL PRIMARY KEY,
  product_name VARCHAR(100),
  category VARCHAR(50)
);
```

**Sample Data:**

**orders Table:**

| order_id | customer_id | order_date  |
|---------|-------------|------------|
| 1        | 1           | 2023-10-26 |
| 2        | 2           | 2023-10-26 |
| 3        | 1           | 2023-10-27 |

**order_items Table:**

| order_item_id | order_id | product_id | quantity | unit_price |
|--------------|----------|------------|----------|------------|
| 1             | 1        | 1           | 2        | 10.00      |
| 2             | 1        | 2           | 1        | 15.00      |
| 3             | 2        | 3           | 3        | 5.00       |
| 4             | 3        | 2           | 2        | 15.00      |

**products Table:**

| product_id | product_name       | category    |
|------------|--------------------|-------------|
| 1           | Laptop             | Electronics |
| 2           | Wireless Headphones | Electronics |
| 3           | Coffee Beans       | Grocery    |

**Desired Output:**

| category    | total_revenue |
|-------------|---------------|
| Electronics | 65.00         |
| Grocery    | 15.00         |


### Question 3

**Scenario:** You need to identify customers who placed orders in the last quarter but haven't placed any orders in the current quarter. 

**Table Structures:** (Use the same `orders` table from the medium question)

**Sample Data:** (Use the same `orders` table data from the medium question, but assume the current date is sometime in January 2024) 

**Desired Output:**

| customer_id | 
|-------------|
| 2           | 

**Explanation:**

Since the current date is in January 2024, the last quarter would be Q4 2023 (October-December 2023). Only customer with `customer_id` 2 placed an order in the last quarter and hasn't placed one in the current quarter.



# MongoDB

### Question 1
**Scenario:** You have a collection of books with titles and authors. Retrieve the titles of all books written by "Jane Austen".

**Collection:** `books`

**Example Documents:**

```json
{ "_id": 1, "title": "Pride and Prejudice", "author": "Jane Austen" },
{ "_id": 2, "title": "Sense and Sensibility", "author": "Jane Austen" },
{ "_id": 3, "title": "1984", "author": "George Orwell" }
```

**Desired Output:**

```json
[
  { "title": "Pride and Prejudice" },
  { "title": "Sense and Sensibility" }
]
```

### Question 2
**Scenario:** You have a collection of products with names, prices, and categories.  List the names and prices of all products in the "Electronics" category, sorted in descending order of price.

**Collection:** `products`

**Example Documents:**

```json
{ "_id": 1, "name": "Laptop", "price": 1200, "category": "Electronics" },
{ "_id": 2, "name": "Keyboard", "price": 75, "category": "Electronics" },
{ "_id": 3, "name": "Coffee Beans", "price": 20, "category": "Grocery" },
{ "_id": 4, "name": "Monitor", "price": 300, "category": "Electronics" }
```

**Desired Output:**

```json
[
  { "name": "Laptop", "price": 1200 },
  { "name": "Monitor", "price": 300 },
  { "name": "Keyboard", "price": 75 }
]
```

### Question 3
**Scenario:** You have a collection of orders with customer IDs, order dates, and an array of items (each item has a product ID and quantity). Find the customers who have ordered the product with `product_id: 10` at least twice in the last 30 days. 

**Collection:** `orders`

**Example Document:**

```json
{ 
    "_id": 1, 
    "customer_id": 123, 
    "order_date": ISODate("2023-11-15T10:00:00Z"), 
    "items": [
        { "product_id": 10, "quantity": 2 },
        { "product_id": 15, "quantity": 1 }
    ]
},
{ 
    "_id": 2, 
    "customer_id": 456, 
    "order_date": ISODate("2023-11-20T14:30:00Z"), 
    "items": [
        { "product_id": 5, "quantity": 3 }
    ]
},
{ 
    "_id": 3, 
    "customer_id": 123, 
    "order_date": ISODate("2023-12-05T08:45:00Z"), 
    "items": [
        { "product_id": 10, "quantity": 1 },
        { "product_id": 22, "quantity": 4 }
    ]
}
```

**Desired Output:**

```json
[
  { "customer_id": 123 } 
]
``` 
